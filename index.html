<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´ë©”ë¼ ê¸´ê¸‰ ì ê²€</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html5-qrcode/html5-qrcode.min.js"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>

    <style>
        body { text-align: center; padding: 20px; font-family: sans-serif; background: #f4f4f4; }
        #reader { width: 100%; max-width: 400px; margin: 0 auto; background: #000; min-height: 300px; border: 5px solid #007bff; border-radius: 10px; }
        .btn { padding: 20px; width: 90%; font-size: 20px; font-weight: bold; margin-top: 20px; cursor: pointer; border-radius: 10px; border: none; }
        .btn-blue { background: #007bff; color: white; }
        .btn-green { background: #28a745; color: white; }
        #log { margin-top: 20px; padding: 10px; background: #eee; font-size: 12px; text-align: left; border-radius: 5px; }
    </style>
</head>
<body>

    <h2>ğŸ“¦ ì¹´ë©”ë¼ ê¸´ê¸‰ ë³µêµ¬ í…ŒìŠ¤íŠ¸</h2>
    
    <div id="reader"></div>

    <button class="btn btn-blue" onclick="testQR()">1. QR ìŠ¤ìºë„ˆ ì‹¤í–‰ (ë„êµ¬ ì‚¬ìš©)</button>
    
    <button class="btn btn-green" onclick="testNative()">2. ìƒ(Raw) ì¹´ë©”ë¼ í…ŒìŠ¤íŠ¸</button>

    <div id="log">ë¡œê·¸ ê¸°ë¡: ëŒ€ê¸° ì¤‘...</div>

    <script>
        function addLog(msg) {
            const log = document.getElementById('log');
            log.innerHTML += "<br>> " + msg;
        }

        // ë°©ë²• 1: ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•œ QR ìŠ¤ìº” í…ŒìŠ¤íŠ¸
        function testQR() {
            addLog("QR ìŠ¤ìºë„ˆ ì‹œë„ ì¤‘...");
            if (typeof Html5QrCode === "undefined") {
                addLog("âŒ ì‹¤íŒ¨: ì—¬ì „íˆ ë„êµ¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
                alert("ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨! ì™€ì´íŒŒì´ë¥¼ ë„ê³  LTEë¡œ ì‹œë„í•˜ê±°ë‚˜ ë¸Œë¼ìš°ì €ë¥¼ ë°”ê¿”ë³´ì„¸ìš”.");
                return;
            }

            const scanner = new Html5QrCode("reader");
            scanner.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (text) => {
                alert("ì„±ê³µ! ê²°ê³¼: " + text);
            }).then(() => {
                addLog("âœ… QR ìŠ¤ìºë„ˆ ì •ìƒ ì‘ë™ ì¤‘!");
            }).catch(err => {
                addLog("âŒ ìŠ¤ìºë„ˆ ì—ëŸ¬: " + err);
            });
        }

        // ë°©ë²• 2: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ í° ìì²´ ì¹´ë©”ë¼ë§Œ ë„ìš°ê¸° (ì´ê²Œ ë˜ë©´ 100% ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„œë²„ ë¬¸ì œì…ë‹ˆë‹¤)
        function testNative() {
            addLog("ìƒ ì¹´ë©”ë¼(Native) ì‹œë„ ì¤‘...");
            const constraints = { video: { facingMode: "environment" } };
            
            navigator.mediaDevices.getUserMedia(constraints)
            .then((stream) => {
                const reader = document.getElementById('reader');
                reader.innerHTML = '<video id="v" autoplay playsinline style="width:100%"></video>';
                document.getElementById('v').srcObject = stream;
                addLog("âœ… ìƒ ì¹´ë©”ë¼ ì‘ë™ ì„±ê³µ! (í° í•˜ë“œì›¨ì–´ëŠ” ì •ìƒì…ë‹ˆë‹¤)");
            })
            .catch((err) => {
                addLog("âŒ ìƒ ì¹´ë©”ë¼ ì—ëŸ¬: " + err);
                alert("ì¹´ë©”ë¼ ê¶Œí•œ ìì²´ê°€ ì°¨ë‹¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì„¤ì •ì—ì„œ ë¸Œë¼ìš°ì € ì¹´ë©”ë¼ ê¶Œí•œì„ í™•ì¸í•˜ì„¸ìš”.");
            });
        }
    </script>
</body>
</html>
